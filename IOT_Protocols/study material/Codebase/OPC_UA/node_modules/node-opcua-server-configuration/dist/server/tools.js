"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.hasEncryptedChannel = exports.hasExpectedUserAccess = void 0;
const node_opcua_address_space_1 = require("node-opcua-address-space");
const node_opcua_secure_channel_1 = require("node-opcua-secure-channel");
function hasExpectedUserAccess(context) {
    if (!context ||
        !context.session ||
        !context.session.userIdentityToken) {
        return false;
    }
    return context.currentUserHasRole(node_opcua_address_space_1.WellKnownRoles.SecurityAdmin);
}
exports.hasExpectedUserAccess = hasExpectedUserAccess;
function hasEncryptedChannel(context) {
    var _a, _b;
    return !!(((_b = (_a = context.session) === null || _a === void 0 ? void 0 : _a.channel) === null || _b === void 0 ? void 0 : _b.securityMode) === node_opcua_secure_channel_1.MessageSecurityMode.SignAndEncrypt);
}
exports.hasEncryptedChannel = hasEncryptedChannel;
//# sourceMappingURL=tools.js.map